COMMAND init
SYNOPSIS: python3 scripts/fdd.py init [options]
DESCRIPTION: Initialize FDD config and minimal adapter for a project
WORKFLOW: adapter

ARGUMENTS:

OPTIONS:
  --project-root  <path>  Project root directory to create .fdd-config.json in (default: parent of FDD core)
  --fdd-root  <path>  Explicit FDD core root (optional override)
  --adapter-path  <path>  Adapter directory path relative to project root (default: FDD-Adapter)
  --project-name  <string>  Project name used in adapter AGENTS.md (default: project root folder name)
  --yes  <boolean>  Do not prompt; accept defaults
  --dry-run  <boolean>  Compute changes without writing files
  --force  <boolean>  Overwrite existing files

EXIT CODES:
  0  Initialization successful
  1  Error (conflicts, invalid paths, etc.)

EXAMPLE:
  $ python3 scripts/fdd.py init
  $ python3 scripts/fdd.py init --yes
  $ python3 scripts/fdd.py init --project-root . --adapter-path FDD-Adapter --yes
  $ python3 scripts/fdd.py init --dry-run
  $ python3 scripts/fdd.py init --force

RELATED:
  - @CLI.adapter-info
  - @CLI.agents
  - @Workflow.adapter
---

COMMAND validate
SYNOPSIS: python3 scripts/fdd.py validate [--artifact <path>] [options]
DESCRIPTION: Validate FDD artifacts using template-based parsing. Validates structure against template, cross-references between artifacts, and task statuses.
WORKFLOW: design-validate, features-validate, feature-validate, prd-validate, adr-validate

ARGUMENTS:

OPTIONS:
  --artifact  <path>  Path to specific FDD artifact (if omitted, validates all registered FDD artifacts)
  --verbose  <boolean>  Print full validation report (default: compact summary)
  --output  <path>  Save validation report to file (default: stdout)

EXIT CODES:
  0  Validation passed
  1  File system error or no adapter found
  2  Validation failed

OUTPUT:
  JSON object with:
  - status: PASS or FAIL
  - artifacts_validated: Number of artifacts checked
  - structure_errors: Template structure violations
  - reference_errors: Cross-reference issues (undefined IDs, broken links)
  - status_errors: Task status inconsistencies
  - traceability: Artifact traceability mode (FULL or DOCS-ONLY)

EXAMPLE:
  $ python3 scripts/fdd.py validate
  $ python3 scripts/fdd.py validate --artifact architecture/PRD.md
  $ python3 scripts/fdd.py validate --verbose
  $ python3 scripts/fdd.py validate --output report.json

RELATED:
  - @CLI.list-ids
  - @CLI.where-defined
  - @CLI.where-used
  - @CLI.validate-rules
  - @Workflow.design-validate
  - @Workflow.feature-validate
---

COMMAND validate-rules
SYNOPSIS: python3 scripts/fdd.py validate-rules [--rule <id>] [--template <path>] [options]
DESCRIPTION: Validate FDD rules configuration and template files. Checks rule definitions in artifacts.json and validates template frontmatter, paired markers, and valid marker types/attributes.
WORKFLOW: rules

ARGUMENTS:

OPTIONS:
  --rule  <id>  Rule ID to validate (if omitted, validates all rules)
  --template  <path>  Path to specific template file to validate
  --verbose  <boolean>  Print full validation report

EXIT CODES:
  0  Validation passed
  1  File system error or no adapter found
  2  Validation failed

OUTPUT:
  JSON object with:
  - status: PASS or FAIL
  - rules_validated: Number of rules checked
  - templates_validated: Number of templates checked
  - error_count: Total errors found
  - errors: List of validation errors (config issues, structure issues, unclosed markers, etc.)

EXAMPLE:
  $ python3 scripts/fdd.py validate-rules
  $ python3 scripts/fdd.py validate-rules --rule fdd-sdlc
  $ python3 scripts/fdd.py validate-rules --template templates/PRD.template.md
  $ python3 scripts/fdd.py validate-rules --verbose

RELATED:
  - @CLI.validate
  - @CLI.validate-code
  - @Workflow.rules
---

COMMAND validate-code
SYNOPSIS: python3 scripts/fdd.py validate-code [path] [options]
DESCRIPTION: Validate FDD traceability markers in code files. Checks marker pairing (@fdd-begin/@fdd-end), empty blocks, orphaned markers (code refs IDs not in artifacts), and coverage (to_code="true" IDs without code markers). Respects traceability mode (FULL vs DOCS-ONLY).
WORKFLOW: code-validate

ARGUMENTS:
  path  <path>  optional  Path to code file or directory (defaults to codebase entries from artifacts.json)

OPTIONS:
  --system  <string>  System name to validate (if omitted, validates all systems)
  --verbose  <boolean>  Print full validation report
  --output  <path>  Save validation report to file (default: stdout)

EXIT CODES:
  0  Validation passed
  1  File system error or no adapter found
  2  Validation failed (orphaned markers, missing coverage, etc.)

OUTPUT:
  JSON object with:
  - status: PASS or FAIL
  - code_files_scanned: Number of code files checked
  - artifact_ids_total: Total IDs defined in artifacts
  - to_code_ids_total: IDs marked to_code="true"
  - code_ids_found: IDs found in code markers
  - coverage: Coverage ratio (found/required)
  - error_count: Total errors
  - errors: List of validation errors (orphaned markers, missing coverage, etc.)
  - next_step: Hint for agent on what to do next (when PASS)

EXAMPLE:
  $ python3 scripts/fdd.py validate-code
  $ python3 scripts/fdd.py validate-code skills/fdd/scripts/
  $ python3 scripts/fdd.py validate-code --system FDD --verbose
  $ python3 scripts/fdd.py validate-code --output code-report.json

RELATED:
  - @CLI.validate
  - @CLI.list-ids
  - @Workflow.code-validate
---

COMMAND list-ids
SYNOPSIS: python3 scripts/fdd.py list-ids [--artifact <path>] [options]
DESCRIPTION: List all FDD IDs from artifacts using template-based parsing. If no artifact is specified, scans all FDD-format artifacts registered in the adapter. Use --include-code to also scan code files for FDD marker references.

ARGUMENTS:

OPTIONS:
  --artifact  <path>  Path to FDD artifact file (optional - if omitted, scans all registered FDD artifacts)
  --pattern  <string>  Filter IDs by substring or regex pattern
  --regex  <boolean>  Treat pattern as regular expression
  --kind  <string>  Filter by ID kind from template markers (e.g., 'requirement', 'feature', 'actor')
  --all  <boolean>  Include duplicate IDs in results
  --include-code  <boolean>  Also scan code files for FDD marker references

EXIT CODES:
  0  Success
  1  File system error, artifact not found, or no adapter found

OUTPUT:
  JSON object with:
  - count: Number of IDs found
  - artifacts_scanned: Number of artifacts scanned
  - code_files_scanned: Number of code files scanned (when --include-code)
  - ids: List of ID objects with id, kind, type, artifact_type, line, artifact, checked

EXAMPLE:
  $ python3 scripts/fdd.py list-ids
  $ python3 scripts/fdd.py list-ids --artifact architecture/PRD.md
  $ python3 scripts/fdd.py list-ids --pattern "-actor-"
  $ python3 scripts/fdd.py list-ids --kind requirement
  $ python3 scripts/fdd.py list-ids --include-code
  $ python3 scripts/fdd.py list-ids --artifact architecture/DESIGN.md --pattern "feature-.*" --regex

RELATED:
  - @CLI.where-defined
  - @CLI.get-content
  - @CLI.validate-code
---

COMMAND list-id-kinds
SYNOPSIS: python3 scripts/fdd.py list-id-kinds [--artifact <path>]
DESCRIPTION: List ID kinds that actually exist in artifacts. Parses artifacts against their templates and returns only kinds that have at least one ID definition.

ARGUMENTS:

OPTIONS:
  --artifact  <path>  Scan specific artifact (if omitted, scans all registered FDD artifacts)

EXIT CODES:
  0  Success
  1  File system error, no adapter found, or artifact not in registry

OUTPUT:
  JSON object with:
  - kinds: List of ID kinds found in artifact(s)
  - kind_counts: Mapping of kind -> count of IDs
  - kind_to_templates: Mapping of kind -> list of template types where found
  - template_to_kinds: Mapping of template type -> list of kinds found
  - artifacts_scanned: Number of artifacts scanned

EXAMPLE:
  $ python3 scripts/fdd.py list-id-kinds
  $ python3 scripts/fdd.py list-id-kinds --artifact architecture/PRD.md

RELATED:
  - @CLI.list-ids
---

COMMAND get-content
SYNOPSIS: python3 scripts/fdd.py get-content (--artifact <path> | --code <path>) --id <string> [--inst <string>]
DESCRIPTION: Get content block for a specific FDD ID. Works with both artifacts (template-based parsing) and code files (FDD marker parsing).

ARGUMENTS:

OPTIONS:
  --artifact  <path>  Path to FDD artifact file (mutually exclusive with --code)
  --code  <path>  Path to code file (mutually exclusive with --artifact)
  --id  <string>  required  FDD ID to retrieve content for
  --inst  <string>  Instruction ID for code blocks (e.g., 'inst-validate-input')

EXIT CODES:
  0  Success
  1  File system error or file not found
  2  ID not found

EXAMPLE:
  $ python3 scripts/fdd.py get-content --artifact architecture/PRD.md --id fdd-myapp-actor-admin
  $ python3 scripts/fdd.py get-content --artifact architecture/DESIGN.md --id fdd-myapp-req-auth
  $ python3 scripts/fdd.py get-content --code src/auth.py --id fdd-myapp-feature-auth-flow-login
  $ python3 scripts/fdd.py get-content --code src/auth.py --id fdd-myapp-feature-auth-flow-login --inst inst-validate-creds

RELATED:
  - @CLI.list-ids
  - @CLI.validate-code
---

COMMAND adapter-info
SYNOPSIS: python3 scripts/fdd.py adapter-info [options]
DESCRIPTION: Discover FDD adapter configuration and location in a project

ARGUMENTS:

OPTIONS:
  --root  <path>  Project root directory to search from (default: current directory)
  --fdd-root  <path>  Known FDD core location for enhanced validation

EXIT CODES:
  0  Adapter found
  1  File system error
  2  Adapter not found

EXAMPLE:
  $ python3 scripts/fdd.py adapter-info
  $ python3 scripts/fdd.py adapter-info --root /path/to/project
  $ python3 scripts/fdd.py adapter-info --root . --fdd-root ../FDD

RELATED:
  - @Workflow.adapter
---

COMMAND where-defined
SYNOPSIS: python3 scripts/fdd.py where-defined --id <id> [options]
DESCRIPTION: Find where an FDD ID is defined using template-based parsing. Scans all registered FDD artifacts.

ARGUMENTS:
  id  <string>  required  FDD ID to find definition for

OPTIONS:
  --artifact  <path>  Limit search to specific artifact (optional)

EXIT CODES:
  0  Exactly one definition found
  1  File system error or no adapter found
  2  ID not found or ambiguous (multiple definitions)

EXAMPLE:
  $ python3 scripts/fdd.py where-defined --id fdd-myapp-actor-admin
  $ python3 scripts/fdd.py where-defined --id fdd-myapp-req-auth
  $ python3 scripts/fdd.py where-defined --id fdd-myapp-feature-auth --artifact architecture/features/FEATURES.md

RELATED:
  - @CLI.where-used
  - @CLI.list-ids
  - @CLI.get-content
---

COMMAND where-used
SYNOPSIS: python3 scripts/fdd.py where-used --id <id> [options]
DESCRIPTION: Find all references to an FDD ID using template-based parsing. Scans all registered FDD artifacts.

ARGUMENTS:
  id  <string>  required  FDD ID to find references for

OPTIONS:
  --artifact  <path>  Limit search to specific artifact (optional)
  --include-definitions  <boolean>  Include definitions in results (default: references only)

EXIT CODES:
  0  Success (references found or not found)
  1  File system error or no adapter found

EXAMPLE:
  $ python3 scripts/fdd.py where-used --id fdd-myapp-actor-admin
  $ python3 scripts/fdd.py where-used --id fdd-myapp-req-auth
  $ python3 scripts/fdd.py where-used --id fdd-myapp-feature-auth --artifact architecture/DESIGN.md

RELATED:
  - @CLI.where-defined
  - @CLI.list-ids
  - @CLI.get-content
---

COMMAND agents
SYNOPSIS: python3 scripts/fdd.py agents --agent <name> [options]
DESCRIPTION: Generate/update agent-specific workflow proxies and skill outputs. Creates unified proxy files for workflows (fdd-generate, fdd-validate, fdd-adapter, fdd-rules) and the fdd skill entry point. Supports windsurf, cursor, claude, copilot.
WORKFLOW: adapter

ARGUMENTS:

OPTIONS:
  --agent  <string>  required  Agent/IDE key (windsurf, cursor, claude, copilot)
  --root  <path>  Project root directory to search from (default: current directory)
  --fdd-root  <path>  Explicit FDD core root (optional override)
  --config  <path>  Path to unified agents config JSON (default: {project-root}/fdd-agents.json)
  --dry-run  <boolean>  Compute changes without writing files

EXIT CODES:
  0  Success (all workflows and skills synced)
  1  Error (invalid args, missing project root, invalid config)

OUTPUT:
  JSON object with:
  - status: PASS or PARTIAL
  - agent: Agent name
  - workflows: Object with created/updated/renamed/deleted counts
  - skills: Object with created/updated counts and outputs list
  - errors: List of errors if any

EXAMPLE:
  $ python3 scripts/fdd.py agents --agent windsurf
  $ python3 scripts/fdd.py agents --agent claude --dry-run
  $ python3 scripts/fdd.py agents --agent cursor

RELATED:
  - @CLI.init
  - @CLI.adapter-info
  - @Workflow.adapter

---

COMMAND self-check
SYNOPSIS: python3 scripts/fdd.py self-check [--rule <id>] [--verbose]
DESCRIPTION: Validate example artifacts against their templates (template QA). For each rule package, checks that example.md passes validation against template.md. Ensures templates and examples remain synchronized.
WORKFLOW: rules

ARGUMENTS:

OPTIONS:
  --rule  <id>  Rule ID to check (if omitted, checks all rules)
  --verbose  <boolean>  Print detailed validation report

EXIT CODES:
  0  All examples pass validation
  1  File system error or no adapter found
  2  One or more examples failed validation

OUTPUT:
  JSON object with:
  - status: PASS or FAIL
  - rules_checked: Number of rules checked
  - examples_checked: Number of examples validated
  - pass_count: Examples that passed
  - fail_count: Examples that failed
  - failures: List of failed examples with error details

EXAMPLE:
  $ python3 scripts/fdd.py self-check
  $ python3 scripts/fdd.py self-check --rule fdd-sdlc
  $ python3 scripts/fdd.py self-check --verbose

RELATED:
  - @CLI.validate-rules
  - @CLI.validate
  - @Workflow.rules
