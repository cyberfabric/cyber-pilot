---
cypilot: true
type: spec
name: Checklist Specification
version: 1.0
purpose: Define the format, generation algorithm, and usage of generated checklist.md files
drivers:
  - cpt-cypilot-fr-core-blueprint
  - cpt-cypilot-component-blueprint-processor
---

# Checklist Specification (checklist.md)

---

## Table of Contents

- [Checklist Specification (checklist.md)](#checklist-specification-checklistmd)
  - [Overview](#overview)
  - [Location](#location)
  - [Source Markers](#source-markers)
  - [Generation Algorithm](#generation-algorithm)
  - [File Format](#file-format)
  - [Domain Sections](#domain-sections)
  - [Check Items](#check-items)
  - [Applicability Conditions](#applicability-conditions)
  - [Example](#example)
  - [Usage](#usage)
  - [Error Handling](#error-handling)

---

## Overview

`checklist.md` is a **generated** output file that provides a structured quality checklist for an artifact kind. It is produced by the Blueprint Processor from `@cpt:checklist` and `@cpt:check` markers, organized by expertise domain and check kind (MUST HAVE / MUST NOT HAVE).

**Key properties**:
- Generated from blueprint — do not edit manually
- Organized by expertise domain (e.g., Business, Architecture, Security, Testing)
- Each domain has MUST HAVE and MUST NOT HAVE sections
- Severity levels: CRITICAL, HIGH, MEDIUM, LOW
- Used by analyze workflows for semantic quality review
- Regenerated by `cypilot generate-resources`

---

## Location

**Per-artifact**: `{cypilot_path}/config/kits/<slug>/artifacts/<KIND>/checklist.md`

**Codebase**: `{cypilot_path}/config/kits/<slug>/codebase/checklist.md` (from blueprints without `artifact` key)

---

## Source Markers

| Marker | Role |
|--------|------|
| `@cpt:checklist` | Structure skeleton — severity levels, review priority, domain definitions |
| `@cpt:check` | Individual check item with domain, severity, kind, and task-list content |

See [blueprint.md spec](blueprint.md) for full marker reference.

---

## Generation Algorithm

1. Parse `@cpt:checklist` TOML to extract domain list, severity levels, and review priority.
2. Collect all `@cpt:check` blocks, group by `domain` → `kind` (`must_have` / `must_not_have`).
3. For each domain (in the order defined by `[[domain]]` array):
   a. Emit domain header with full name and referenced standards.
   b. Emit applicability table (if any checks have `applicable_when` / `not_applicable_when`).
   c. Emit **MUST HAVE** section with checks sorted by severity (CRITICAL first).
   d. Emit **MUST NOT HAVE** section with checks sorted by severity.
4. Emit severity legend at the end of the file.

**Determinism guarantee**: same blueprint → identical `checklist.md` (byte-for-byte).

---

## File Format

```markdown
# PRD Quality Checklist

**Artifact**: PRD
**Kit**: sdlc

**Severity levels**: CRITICAL > HIGH > MEDIUM > LOW
**Review priority**: BIZ → ARCH → SEC → TEST

---

## BIZ — Business

**Standards**: ISO/IEC/IEEE 29148:2018 §6.2 (StRS), §6.4 (SRS)

### MUST HAVE

#### BIZ-PRD-001 — Vision Clarity [CRITICAL]

- [ ] Purpose statement explains WHY the product exists
- [ ] Target users clearly identified with specificity (not just "users")
- [ ] Key problems solved are concrete and measurable

> **Ref**: ISO/IEC/IEEE 29148 §5.2.5

#### BIZ-PRD-002 — Scope Boundaries [HIGH]

- [ ] In-scope items explicitly listed
- [ ] Out-of-scope items explicitly listed

### MUST NOT HAVE

#### BIZ-PRD-NO-001 — No Implementation Details [CRITICAL]

- [ ] No database schema definitions
- [ ] No API endpoint specifications

> **Belongs to**: DESIGN

---

## ARCH — Architecture

...
```

---

## Domain Sections

Each domain section contains:

1. **Domain header**: `## {ABBR} — {Name}`
2. **Standards line**: referenced standards from `[[domain]].standards`
3. **Applicability table** (if any checks have conditions):
   ```markdown
   | Check | Applicable When | Not Applicable When |
   |-------|----------------|-------------------|
   | BIZ-PRD-003 | Multiple user roles | Single-user system |
   ```
4. **MUST HAVE** subsection: checks with `kind = "must_have"`
5. **MUST NOT HAVE** subsection: checks with `kind = "must_not_have"`

---

## Check Items

Each check item is rendered as:

```markdown
#### {ID} — {Title} [{SEVERITY}]

{task-list content from ```markdown block}

> **Ref**: {ref}                    # if ref is set
> **Belongs to**: {belongs_to}      # if belongs_to is set (must_not_have items)
```

Checks within each kind section are sorted by severity (CRITICAL → HIGH → MEDIUM → LOW), then by definition order within the same severity.

---

## Applicability Conditions

Checks may have conditional applicability:

| TOML Key | Effect |
|----------|--------|
| `applicable_when` | Check applies only when the condition is true |
| `not_applicable_when` | Check does not apply when the condition is true |
| Both omitted | Check always applies |

Conditions are rendered in the applicability table at the top of the domain section.

---

## Example

Given these blueprint markers:

```toml
# @cpt:checklist
[severity]
levels = ["CRITICAL", "HIGH", "MEDIUM", "LOW"]
[review]
priority = ["BIZ", "ARCH"]
[[domain]]
abbr = "BIZ"
name = "Business"
standards = ["ISO/IEC/IEEE 29148:2018"]
```

```toml
# @cpt:check
id = "BIZ-PRD-001"
domain = "BIZ"
title = "Vision Clarity"
severity = "CRITICAL"
kind = "must_have"
```

Generated checklist.md includes:

```markdown
## BIZ — Business

**Standards**: ISO/IEC/IEEE 29148:2018

### MUST HAVE

#### BIZ-PRD-001 — Vision Clarity [CRITICAL]

- [ ] Purpose statement explains WHY the product exists
...
```

---

## Usage

- **Analyze workflows**: load `checklist.md` as semantic quality criteria for artifact review
- **Generate workflows**: reference `checklist.md` to ensure generated content meets quality standards
- **Agent context**: agents use domain-organized checklists to systematically validate artifact quality

---

## Error Handling

| Error | Cause | Resolution |
|-------|-------|------------|
| `CHECKLIST_NO_DOMAINS` | `@cpt:checklist` has no `[[domain]]` entries | Add at least one domain definition |
| `CHECKLIST_UNKNOWN_DOMAIN` | `@cpt:check.domain` doesn't match any `[[domain]].abbr` | Fix domain abbreviation or add domain to `@cpt:checklist` |
| `CHECKLIST_UNKNOWN_SEVERITY` | `@cpt:check.severity` not in `[severity].levels` | Use a defined severity level |
| `CHECKLIST_DUPLICATE_ID` | Two `@cpt:check` blocks with same `id` | Use unique check IDs |
